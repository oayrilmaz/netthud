<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Net Thud — Goal Intelligence</title>
  <meta name="description" content="Net Thud tracks decisive football moments. Scores, upcoming + TV, transfers, and AI signals." />

  <style>
    :root{
      --bg:#0b0d10;
      --card:#141821;
      --text:#eaeef3;
      --muted:#9aa3ad;
      --accent:#78ff6a;
      --warn:#ffd166;
      --border:rgba(255,255,255,.08);
      --radius:16px;
      --container:1100px;
      --headerH:64px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;
      background:var(--bg);
      color:var(--text);
      overflow:hidden; /* page itself doesn't scroll; main scrolls */
    }
    a{color:inherit;text-decoration:none}
    .container{max-width:var(--container);margin:0 auto;padding:24px}

    /* Header */
    header{
      border-bottom:1px solid var(--border);
      background:#0f1218;
      position:sticky;top:0;z-index:30;
    }
    .nav{
      display:flex;justify-content:space-between;align-items:center;
      height:var(--headerH);gap:12px
    }
    .brandWrap{display:flex;flex-direction:column;gap:2px}
    .brand{
      font-weight:950;letter-spacing:.06em;font-size:15px;
      display:flex;align-items:center;gap:10px;text-transform:uppercase;
    }
    .brandMark{
      width:10px;height:10px;border-radius:999px;
      background:var(--accent);
      box-shadow:0 0 18px rgba(120,255,106,.35);
    }
    .subtitle{font-size:12px;color:var(--muted)}
    .right{display:flex;align-items:center;gap:10px}
    .pill{
      display:inline-flex;align-items:center;gap:8px;
      padding:8px 12px;border-radius:999px;
      border:1px solid var(--border);
      background:#0f131b;font-size:12px;color:var(--muted);
      cursor:pointer
    }
    .pill a{cursor:pointer}
    .dot{width:8px;height:8px;border-radius:99px;background:var(--accent);box-shadow:0 0 12px rgba(120,255,106,.35)}

    /* Main */
    main{
      height:calc(100vh - var(--headerH));
      overflow:auto;
      padding:18px 0 24px;
    }

    h1{font-size:42px;margin:0 0 12px}
    p.lead{color:var(--muted);max-width:70ch;line-height:1.7;margin:0}

    .disclaimer{
      margin-top:12px;font-size:12px;color:var(--muted);
      line-height:1.5;border:1px solid var(--border);
      background:#0f1218;padding:10px 12px;border-radius:12px;
    }

    /* Tabs */
    .tabsBar{
      position:sticky;top:var(--headerH);
      z-index:25;
      background:linear-gradient(to bottom, rgba(11,13,16,.96), rgba(11,13,16,.70));
      backdrop-filter: blur(6px);
      border-bottom:1px solid var(--border);
      margin-top:14px;
      padding:12px 0;
    }
    .tabsRow{
      display:flex;gap:10px;flex-wrap:wrap;
      padding:0 24px;max-width:var(--container);margin:0 auto;
    }
    .tabBtn{
      display:inline-flex;align-items:center;gap:10px;
      padding:10px 14px;border-radius:12px;
      border:1px solid var(--border);
      background:#0f131b;font-weight:900;font-size:13px;
      cursor:pointer;user-select:none;
    }
    .tabBtn.active{
      border-color:rgba(120,255,106,.55);
      box-shadow:0 0 0 1px rgba(120,255,106,.14) inset, 0 0 18px rgba(120,255,106,.08);
    }
    .tabBtn:active{transform:translateY(1px)}

    /* Sections */
    .stack{
      display:grid;gap:18px;
      padding:18px 24px 0;
      max-width:var(--container);margin:0 auto;
    }
    .card{
      background:var(--card);
      border:1px solid var(--border);
      border-radius:var(--radius);
      padding:14px;
      min-height:0;
    }
    .boxHead{
      display:flex;justify-content:space-between;align-items:center;gap:12px;
      padding:10px 12px;border-radius:12px;
      border:1px solid var(--border);
      background:#0f1218;margin-bottom:12px;
    }
    .boxHead .title{
      font-size:12px;letter-spacing:.14em;
      text-transform:uppercase;font-weight:900
    }
    .boxHead .hint{font-size:12px;color:var(--muted);white-space:nowrap}

    .list{
      display:grid;gap:12px;
      max-height:min(62vh,560px);
      overflow:auto;padding-right:6px;
    }

    .item{
      display:flex;justify-content:space-between;align-items:flex-start;gap:16px;
      padding:14px;border-radius:12px;
      background:#0f131b;border:1px solid var(--border)
    }
    .item strong{font-size:15px;display:block}
    .item p{margin:6px 0 0;font-size:13px;color:var(--muted);line-height:1.35}

    .tag{
      font-size:11px;font-weight:900;
      padding:6px 10px;border-radius:999px;
      border:1px solid rgba(120,255,106,.3);
      color:var(--accent);
      white-space:nowrap
    }
    .tag.warn{border-color:rgba(255,209,102,.35);color:var(--warn)}
    .tag.live{border-color:rgba(120,255,106,.55);box-shadow:0 0 0 1px rgba(120,255,106,.12) inset}
    .tag.signal{border-color:rgba(120,255,106,.25);color:var(--text);background:rgba(120,255,106,.06)}
    .tag.conf{border-color:rgba(255,255,255,.12);color:var(--muted);background:rgba(255,255,255,.04)}

    .rowActions{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px}
    .mini{
      display:inline-flex;align-items:center;gap:8px;
      padding:7px 10px;border-radius:999px;
      border:1px solid var(--border);
      background:#0b0f16;
      font-size:12px;font-weight:900;color:var(--text);
      cursor:pointer;user-select:none;
    }
    .mini.secondary{color:var(--muted)}
    .mini:active{transform:translateY(1px)}

    /* Leagues chips */
    .chips{display:flex;flex-wrap:wrap;gap:10px;overflow:auto;max-height:220px;padding-right:6px}
    .chip{
      display:inline-flex;align-items:center;gap:10px;
      padding:10px 14px;border-radius:999px;
      border:1px solid var(--border);
      background:#0f131b;font-size:13px;color:var(--text)
    }
    .chip .dot{width:10px;height:10px}

    footer{
      border-top:1px solid var(--border);
      padding:14px 0;
      font-size:12px;color:var(--muted);
      text-align:center
    }

    .tabSection{display:none}
    .tabSection.active{display:block}
  </style>
</head>

<body>

<header>
  <div class="container nav">
    <div class="brandWrap">
      <div class="brand"><span class="brandMark"></span>NET THUD</div>
      <div class="subtitle">Goal Intelligence</div>
    </div>
    <div class="right">
      <div class="pill" id="soundPill"><span class="dot"></span>Sound: <strong id="soundState">ON</strong></div>
      <a class="pill" href="https://x.com/netthudpro" target="_blank" rel="noopener">@netthudpro</a>
    </div>
  </div>
</header>

<main>

  <div class="container">
    <section>
      <h1>At the moment it matters.</h1>
      <p class="lead">
        Net Thud focuses on decisive outcomes and match context.
        Scores, upcoming fixtures + TV, transfers and AI-driven signals.
      </p>

      <div class="disclaimer" role="note">
        <strong>Note:</strong> NetThud uses automated pipelines (including AI).
        Data may be delayed or incomplete. Always verify with official sources.
      </div>
    </section>
  </div>

  <div class="tabsBar" role="navigation" aria-label="Sections">
    <div class="tabsRow" id="tabsRow">
      <div class="tabBtn active" data-tab="liveScores" id="tab_liveScores">Live scores</div>
      <div class="tabBtn" data-tab="upcoming" id="tab_upcoming">Upcoming + TV</div>
      <div class="tabBtn" data-tab="finalScores" id="tab_finalScores">Final scores</div>
      <div class="tabBtn" data-tab="transferSignals" id="tab_transferSignals">Transfer signals</div>
      <div class="tabBtn" data-tab="aiNews" id="tab_aiNews">AI news</div>
      <div class="tabBtn" data-tab="leagues" id="tab_leagues">Leagues</div>
    </div>
  </div>

  <div class="stack">

    <section id="liveScores" class="tabSection active">
      <div class="card">
        <div class="boxHead">
          <div class="title">Live Scores</div>
          <div class="hint" id="liveMeta">Loading…</div>
        </div>
        <div id="liveList" class="list"></div>
      </div>
    </section>

    <section id="upcoming" class="tabSection">
      <div class="card">
        <div class="boxHead">
          <div class="title">Upcoming + TV</div>
          <div class="hint" id="upcomingMeta">Loading…</div>
        </div>
        <div id="upcomingList" class="list"></div>
      </div>
    </section>

    <section id="finalScores" class="tabSection">
      <div class="card">
        <div class="boxHead">
          <div class="title">Final Scores</div>
          <div class="hint" id="scoresMeta">Loading…</div>
        </div>
        <div id="scoresList" class="list"></div>
      </div>
    </section>

    <section id="transferSignals" class="tabSection">
      <div class="card">
        <div class="boxHead">
          <div class="title">Transfer Signals</div>
          <div class="hint" id="transfersMeta">Loading…</div>
        </div>
        <div id="transfersList" class="list"></div>
      </div>
    </section>

    <section id="aiNews" class="tabSection">
      <div class="card">
        <div class="boxHead">
          <div class="title">AI News</div>
          <div class="hint" id="newsMeta">Loading…</div>
        </div>
        <div id="newsList" class="list"></div>
      </div>
    </section>

    <section id="leagues" class="tabSection">
      <div class="card">
        <div class="boxHead">
          <div class="title">Leagues</div>
          <div class="hint" id="leaguesMeta">Loading…</div>
        </div>
        <div id="leagueChips" class="chips"></div>
      </div>
    </section>

  </div>

  <footer>
    © <span id="year"></span> Net Thud • Goal Intelligence
  </footer>

</main>

<!-- ===== END PART 1 / 4. PART 2 COMING NEXT MESSAGE ===== -->
<!-- Modal -->
<div class="modalOverlay" id="modalOverlay" aria-hidden="true"
  style="position:fixed;inset:0;background:rgba(0,0,0,.68);display:none;z-index:60;padding:18px;">
  <div class="modal" role="dialog" aria-modal="true" aria-labelledby="modalTitle"
    style="width:min(920px,100%);background:var(--card);border:1px solid var(--border);border-radius:18px;overflow:hidden;">
    <div class="modalHeader"
      style="display:flex;justify-content:space-between;gap:12px;padding:14px 16px;border-bottom:1px solid var(--border);background:#0f1218;position:sticky;top:0;">
      <div>
        <div class="modalTitle" id="modalTitle" style="font-weight:900">Details</div>
        <div class="modalMeta" id="modalMeta"
          style="font-size:12px;color:var(--muted);margin-top:4px"></div>
      </div>
      <button class="closeBtn" id="modalClose"
        style="padding:8px 12px;border-radius:12px;border:1px solid var(--border);background:#0f131b;font-weight:900;cursor:pointer;color:var(--text)">
        Close
      </button>
    </div>

    <div class="modalBody" style="padding:16px">
      <div class="modalActions" id="modalActions"
        style="display:flex;gap:10px;flex-wrap:wrap;margin-top:10px"></div>

      <div class="modalContent" id="modalContent"
        style="margin-top:14px;line-height:1.7;color:var(--text);font-size:14px;white-space:pre-wrap"></div>

      <div class="subBox" id="modalKVBox"
        style="display:none;border:1px solid var(--border);background:#0f131b;border-radius:14px;padding:12px;margin-top:12px;">
        <div class="subBoxTitle"
          style="font-weight:900;font-size:12px;letter-spacing:.12em;text-transform:uppercase;color:var(--muted);margin:0 0 8px;">
          Snapshot
        </div>
        <div class="kv" id="modalKV"
          style="display:grid;grid-template-columns:140px 1fr;gap:8px 12px;font-size:13px"></div>
      </div>

      <div class="subBox"
        style="border:1px solid var(--border);background:#0f131b;border-radius:14px;padding:12px;margin-top:12px;">
        <div class="subBoxTitle"
          style="font-weight:900;font-size:12px;letter-spacing:.12em;text-transform:uppercase;color:var(--muted);margin:0 0 8px;">
          Disclosure
        </div>
        <div style="font-size:12px;color:var(--muted);white-space:pre-wrap">
This view is generated automatically and may contain errors.
It is not official match or transfer confirmation.
Always verify with primary sources.
        </div>
      </div>
    </div>
  </div>
</div>

<script>
/* ---------------------------
   PATHS
--------------------------- */
const PATHS = {
  scores:    "/assets/data/scores.json",
  upcoming:  "/assets/data/upcoming.json",
  transfers: "/assets/data/transfers.json",
  news:      "/assets/data/ai-news.json",
  leagues:   "/assets/data/leagues.json"
};

const $ = (id) => document.getElementById(id);
const safeEl = (id) => document.getElementById(id);
const safeSetText = (id, txt) => { const el = safeEl(id); if(el) el.textContent = txt; };

window.addEventListener("error", e =>
  console.error("NetThud JS Error:", e.message, e.filename, e.lineno)
);
window.addEventListener("unhandledrejection", e =>
  console.error("NetThud Promise Error:", e.reason)
);

function esc(s){
  return String(s ?? "")
    .replaceAll("&","&amp;")
    .replaceAll("<","&lt;")
    .replaceAll(">","&gt;")
    .replaceAll('"',"&quot;");
}

async function readJson(url){
  const u = new URL(url, window.location.origin);
  u.searchParams.set("v", Date.now());
  const res = await fetch(u.toString(), { cache:"no-store" });
  if(!res.ok) throw new Error(`Missing ${url}`);
  return res.json();
}

/* Status helpers */
const isLiveStatus = s => ["LIVE","HT","IN_PLAY","PAUSED"].includes(String(s||"").toUpperCase());
const isFinalStatus = s => ["FT","FINISHED"].includes(String(s||"").toUpperCase());

function makeBtn(label, onClick, secondary=false){
  const b = document.createElement("div");
  b.className = "mini" + (secondary ? " secondary" : "");
  b.textContent = label;
  b.onclick = e => { e.stopPropagation(); onClick(); };
  return b;
}

/* Basic row */
function rowBasic(title, meta, tag, cls=""){
  const d = document.createElement("div");
  d.className = "item";
  d.innerHTML = `
    <div>
      <strong>${esc(title)}</strong>
      <p>${esc(meta||"")}</p>
    </div>
    <span class="tag ${cls}">${esc(tag)}</span>
  `;
  return d;
}
</script>

<!-- ===== END PART 2 / 4. PART 3 COMING NEXT MESSAGE ===== -->
<script>
/* ---------------------------
   SCORE + UPCOMING LOADERS
--------------------------- */

let LIVE_INDEX = [];
let FINAL_INDEX = [];
let UPCOMING_INDEX = [];
let SIGNALS_INDEX = [];
let NEWS_INDEX = [];

/* Highlights */
function ytHighlightsUrl(home, away){
  const q = encodeURIComponent(`${home} vs ${away} highlights`);
  return `https://www.youtube.com/results?search_query=${q}`;
}
function openHighlights(item){
  const u = item.highlightsUrl || ytHighlightsUrl(item.home, item.away);
  window.open(u, "_blank", "noopener");
}

/* Clickable row */
function rowClickable({ title, meta, tag, cls="", onClick, buttons=[] }){
  const wrap = document.createElement("div");
  wrap.className = "item";
  wrap.style.cursor = "pointer";

  const left = document.createElement("div");
  left.innerHTML = `<strong>${esc(title)}</strong><p>${esc(meta||"")}</p><div class="rowActions"></div>`;

  const acts = left.querySelector(".rowActions");
  buttons.forEach(b => acts.appendChild(b));

  const right = document.createElement("span");
  right.className = "tag " + cls;
  right.textContent = tag;

  wrap.append(left, right);
  wrap.onclick = e => {
    if(e.target.classList.contains("mini")) return;
    onClick();
  };
  return wrap;
}

/* -------- SCORES -------- */
async function loadScores(){
  const liveList = $("liveList");
  const finalList = $("scoresList");

  try{
    const data = await readJson(PATHS.scores);
    const items = Array.isArray(data.items) ? data.items : [];

    LIVE_INDEX = items.filter(m => isLiveStatus(m.status));
    FINAL_INDEX = items.filter(m => isFinalStatus(m.status));

    safeSetText("liveMeta", `${LIVE_INDEX.length} • updated ${data.updated||"—"}`);
    safeSetText("scoresMeta", `${FINAL_INDEX.length} • updated ${data.updated||"—"}`);

    liveList.innerHTML = "";
    FINAL_INDEX.sort((a,b)=>String(b.kickoffUTC||"").localeCompare(a.kickoffUTC||""));

    if(!LIVE_INDEX.length)
      liveList.appendChild(rowBasic("No live matches", "Check back soon", "—"));
    else
      LIVE_INDEX.slice(0,40).forEach(m=>{
        liveList.appendChild(
          rowClickable({
            title:`${m.home} ${m.score||""} ${m.away}`,
            meta:`${m.league} • ${m.when||""}`,
            tag:"LIVE",
            cls:"live",
            buttons:[ makeBtn("Highlights", ()=>openHighlights(m), true) ],
            onClick:()=>openModal({
              title:`${m.home} vs ${m.away}`,
              meta:m.league,
              article:"Live match details",
              highlightsUrl:m.highlightsUrl
            })
          })
        );
      });

    finalList.innerHTML = "";
    if(!FINAL_INDEX.length)
      finalList.appendChild(rowBasic("No final scores yet", "", "—"));
    else
      FINAL_INDEX.slice(0,60).forEach(m=>{
        finalList.appendChild(
          rowClickable({
            title:`${m.home} ${m.score} ${m.away}`,
            meta:`${m.league} • ${m.when}`,
            tag:"FT",
            buttons:[ makeBtn("Highlights", ()=>openHighlights(m), true) ],
            onClick:()=>openModal({
              title:`${m.home} ${m.score} ${m.away}`,
              meta:m.league,
              article:"Final match summary",
              highlightsUrl:m.highlightsUrl
            })
          })
        );
      });

  }catch(e){
    liveList.innerHTML="";
    finalList.innerHTML="";
    liveList.appendChild(rowBasic("Scores not loading", e.message, "ERR","warn"));
    finalList.appendChild(rowBasic("Scores not loading", e.message, "ERR","warn"));
  }
}

/* -------- UPCOMING -------- */
async function loadUpcoming(){
  const list = $("upcomingList");

  try{
    const data = await readJson(PATHS.upcoming);
    UPCOMING_INDEX = Array.isArray(data.items) ? data.items : [];

    safeSetText("upcomingMeta", `${UPCOMING_INDEX.length} • updated ${data.generatedAt||"—"}`);
    list.innerHTML = "";

    if(!UPCOMING_INDEX.length){
      list.appendChild(rowBasic("No upcoming fixtures", "", "—"));
      return;
    }

    UPCOMING_INDEX.slice(0,60).forEach(g=>{
      const tv = (g.tv && g.tv.length) ? g.tv.join(", ") : "TBA";
      list.appendChild(
        rowClickable({
          title:`${g.home} vs ${g.away}`,
          meta:`${g.league} • ${g.kickoffLocal||""} • TV: ${tv}`,
          tag:"UP",
          onClick:()=>openModal({
            title:`${g.home} vs ${g.away}`,
            meta:g.league,
            article:"Upcoming match preview"
          })
        })
      );
    });

  }catch(e){
    list.innerHTML="";
    list.appendChild(rowBasic("Upcoming not loading", e.message, "ERR","warn"));
  }
}
</script>

<!-- ===== END PART 3 / 4. PART 4 COMING NEXT MESSAGE ===== -->
<script>
/* ---------------------------
   TRANSFER SIGNALS
--------------------------- */

async function loadTransferSignals(){
  const list = $("transfersList");
  try{
    const data = await readJson(PATHS.transfers);
    SIGNALS_INDEX = Array.isArray(data.items) ? data.items : [];

    safeSetText("transfersMeta", `${SIGNALS_INDEX.length} • updated ${data.generatedAt||"—"}`);
    list.innerHTML = "";

    if(!SIGNALS_INDEX.length){
      list.appendChild(rowBasic("No transfer signals yet", "", "—"));
      return;
    }

    SIGNALS_INDEX.slice(0,80).forEach(s=>{
      list.appendChild(
        rowClickable({
          title:s.title || "Transfer signal",
          meta:`${s.source||"NetThud"} • ${String(s.publishedAt||"").slice(0,19)}`,
          tag:(s.stage||"SIG").toUpperCase(),
          cls:"signal",
          onClick:()=>openModal({
            title:s.title,
            meta:s.source,
            article:"AI-generated transfer signal"
          })
        })
      );
    });

  }catch(e){
    list.innerHTML="";
    list.appendChild(rowBasic("Transfer signals not loading", e.message, "ERR","warn"));
  }
}

/* ---------------------------
   AI NEWS
--------------------------- */

async function loadNews(){
  const list = $("newsList");
  try{
    const data = await readJson(PATHS.news);
    NEWS_INDEX = Array.isArray(data.items) ? data.items : [];

    safeSetText("newsMeta", `${NEWS_INDEX.length} • updated ${data.generatedAt||"—"}`);
    list.innerHTML = "";

    if(!NEWS_INDEX.length){
      list.appendChild(rowBasic("No AI news yet", "", "—"));
      return;
    }

    NEWS_INDEX.slice(0,60).forEach(n=>{
      list.appendChild(
        rowClickable({
          title:n.title || "AI News",
          meta:n.summary || "",
          tag:"OPEN",
          onClick:()=>openModal({
            title:n.title,
            meta:n.source || "NetThud AI",
            article:n.article || n.summary || ""
          })
        })
      );
    });

  }catch(e){
    list.innerHTML="";
    list.appendChild(rowBasic("AI news not loading", e.message, "ERR","warn"));
  }
}

/* ---------------------------
   LEAGUES (STATIC JSON)
--------------------------- */

async function loadLeagues(){
  const box = $("leagueChips");
  try{
    const data = await readJson(PATHS.leagues);
    const leagues = Array.isArray(data.items) ? data.items : [];

    safeSetText("leaguesMeta", `${leagues.length} • updated ${data.updated||"—"}`);
    box.innerHTML = "";

    leagues.forEach(l=>{
      const el = document.createElement("div");
      el.className = "chip";
      el.innerHTML = `
        <span class="dot"></span>
        ${esc(l.emoji||"")} ${esc(l.name)} • ${esc(l.country)}
      `;
      box.appendChild(el);
    });

  }catch(e){
    box.innerHTML="";
    box.appendChild(rowBasic("Leagues not loading", e.message, "ERR","warn"));
  }
}

/* ---------------------------
   TABS
--------------------------- */

function showTab(id){
  document.querySelectorAll(".tabSection").forEach(s=>s.classList.remove("active"));
  document.getElementById(id)?.classList.add("active");

  document.querySelectorAll(".tabBtn").forEach(b=>b.classList.remove("active"));
  document.querySelector(`.tabBtn[data-tab="${id}"]`)?.classList.add("active");

  history.replaceState(null,"","#t="+id);
}

function wireTabs(){
  document.querySelectorAll(".tabBtn").forEach(btn=>{
    btn.onclick = ()=>showTab(btn.dataset.tab);
  });
}

/* ---------------------------
   BOOT
--------------------------- */

document.addEventListener("DOMContentLoaded", async ()=>{
  $("year").textContent = new Date().getFullYear();

  wireTabs();

  await loadScores();
  await loadUpcoming();
  await loadTransferSignals();
  await loadNews();
  await loadLeagues();

  if(location.hash.startsWith("#t=")){
    showTab(location.hash.replace("#t=",""));
  }
});
</script>

</body>
</html>